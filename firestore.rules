
rules_version = '2';

/**
 * @file firestore.rules
 * @description Security rules for the MechQuote Firestore database.
 *
 * ## Core Philosophy
 * This ruleset is designed for a prototyping environment with anonymous authentication.
 * It prioritizes rapid development by allowing any signed-in user (including anonymous ones)
 * to read and write data they own, based on the `ownerId` field.
 */
service cloud.firestore {
  match /databases/{database}/documents {

    // Helper Functions
    /**
     * Returns true if the user is authenticated (can be an anonymous user).
     */
    function isSignedIn() {
      return request.auth != null;
    }

    // Temporarily allowing read/write for authenticated users to debug permission issues.
    // This makes the rules less secure but helps identify if the issue is with the rules themselves
    // or with the client-side queries.
    match /{path=**}/document {
        allow read, write: if isSignedIn();
    }
  }
}
